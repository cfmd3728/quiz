<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>é›‘å­¦ã‚¢ãƒ—ãƒªï¼ˆ1å•ãšã¤è¡¨ç¤ºãƒ»çµæœä»˜ãï¼‰</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    h1 {
      text-align: center;
      font-size: 28px;
      margin-bottom: 20px;
    }

    button {
      margin: 5px 0;
      padding: 10px 15px;
      font-size: 16px;
      cursor: pointer;
    }

    .feedback {
      position: fixed;
      top: 100px;
      left: 50%;
      transform: translateX(-50%);
      padding: 15px 30px;
      border-radius: 8px;
      font-size: 18px;
      font-weight: bold;
      opacity: 0;
      transition: opacity 0.5s ease, transform 0.5s ease;
      z-index: 1000;
      pointer-events: none;
    }

    .correct {
      background-color: #4CAF50;
      color: white;
    }

    .wrong {
      background-color: #f44336;
      color: white;
    }

    .show {
      opacity: 1;
      transform: translateX(-50%) translateY(10px);
    }

    .choice-btn {
      display: block;
      width: fit-content;
    }

    .highlight-correct {
      background-color: #4CAF50;
      color: white;
    }

    .highlight-wrong {
      background-color: #f44336;
      color: white;
    }

    #next-btn, #retry-btn {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }

    #result {
      font-size: 20px;
      font-weight: bold;
      margin-top: 30px;
    }
  </style>
</head>
<body>
  <h1>é›‘å­¦ã‚¢ãƒ—ãƒª</h1> <!-- ã“ã“ã«ã‚¿ã‚¤ãƒˆãƒ«ã‚’è¿½åŠ  -->
  <div id="quiz-container"></div>
  <div id="feedback" class="feedback"></div>
  <div id="result"></div>
  <button id="next-btn" style="display:none;">æ¬¡ã®å•é¡Œã¸</button>
  <button id="retry-btn" style="display:none;" onclick="location.reload()">ã‚‚ã†ä¸€åº¦ã‚„ã‚‹</button>

  <script>
    fetch("quizzes.json")
      .then(response => response.json())
      .then(quizzes => {
        const shuffled = quizzes.sort(() => 0.5 - Math.random());
        const selected = shuffled.slice(0, 5);

        const container = document.getElementById("quiz-container");
        const feedback = document.getElementById("feedback");
        const result = document.getElementById("result");
        const nextBtn = document.getElementById("next-btn");
        const retryBtn = document.getElementById("retry-btn");

        let currentIndex = 0;
        let correctCount = 0;

        function showFeedback(message, isCorrect) {
          feedback.textContent = message;
          feedback.className = "feedback " + (isCorrect ? "correct" : "wrong") + " show";
          setTimeout(() => {
            feedback.classList.remove("show");
          }, 1000);
        }

        function showQuestion() {
          container.innerHTML = ""; // å‰ã®å•é¡Œã‚’æ¶ˆã™
          nextBtn.style.display = "none";

          const quiz = selected[currentIndex];

          const questionEl = document.createElement("h2");
          questionEl.textContent = `Q${currentIndex + 1}: ${quiz.question}`;
          container.appendChild(questionEl);

          quiz.choices.forEach((choice, index) => {
            const button = document.createElement("button");
            button.textContent = choice;
            button.className = "choice-btn";
            button.onclick = () => {
              const isCorrect = index === quiz.answer;
              if (isCorrect) correctCount++;

              showFeedback(isCorrect ? "æ­£è§£ï¼ğŸ‰" : "ä¸æ­£è§£â€¦ğŸ˜¢", isCorrect);

              // å…¨ãƒœã‚¿ãƒ³ç„¡åŠ¹åŒ– & æ­£èª¤ãƒã‚¤ãƒ©ã‚¤ãƒˆ
              const allButtons = document.querySelectorAll(".choice-btn");
              allButtons.forEach((btn, i) => {
                btn.disabled = true;
                if (i === quiz.answer) {
                  btn.classList.add("highlight-correct");
                } else if (i === index) {
                  btn.classList.add("highlight-wrong");
                }
              });

              // æ¬¡ã¸ãƒœã‚¿ãƒ³è¡¨ç¤º
              nextBtn.style.display = "inline-block";
            };
            container.appendChild(button);
          });
        }

        nextBtn.onclick = () => {
          currentIndex++;
          if (currentIndex < selected.length) {
            showQuestion();
          } else {
            container.innerHTML = "";
            nextBtn.style.display = "none";
            result.textContent = `ã‚ãªãŸã¯ ${selected.length}å•ä¸­ ${correctCount}å• æ­£è§£ã—ã¾ã—ãŸï¼`;
            retryBtn.style.display = "inline-block";
          }
        };

        // æœ€åˆã®å•é¡Œè¡¨ç¤º
        showQuestion();
      });
  </script>
</body>
</html>
